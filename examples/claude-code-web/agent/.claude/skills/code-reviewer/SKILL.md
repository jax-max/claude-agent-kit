---
name: code-reviewer
description: 代码审查技能，帮助审查代码质量、发现潜在问题、提供改进建议。当用户需要审查代码、检查bug、优化代码质量时使用。
allowed-tools: Read, Edit, Grep, Glob, Bash
---

# Code Reviewer（代码审查）

专业的代码审查技能，帮助识别代码中的问题、潜在bug、性能问题和代码质量改进建议。

## 何时使用此技能

在以下场景使用此技能：
- 审查代码质量和最佳实践
- 发现潜在的bug和安全问题
- 检查代码风格和一致性
- 提供性能优化建议
- 审查代码的可维护性和可读性
- 检查是否符合项目规范

## 如何使用

### 1. 审查单个文件

当用户要求审查特定文件时：
1. 使用 `Read` 工具读取文件内容
2. 分析代码结构、逻辑和潜在问题
3. 检查代码风格、命名规范
4. 识别可能的bug、性能问题、安全问题
5. 提供具体的改进建议

### 2. 审查整个项目

当用户要求审查整个项目时：
1. 使用 `Glob` 工具查找所有代码文件
2. 使用 `Grep` 工具搜索常见问题模式
3. 分析项目结构和组织方式
4. 检查代码一致性和重复代码
5. 提供整体改进建议

### 3. 审查特定问题

当用户关注特定方面时（如性能、安全、可读性）：
- 专注于该方面的审查
- 使用相应的工具和模式匹配
- 提供针对性的建议

## 审查检查清单

### 代码质量
- [ ] 代码可读性和清晰度
- [ ] 命名规范（变量、函数、类）
- [ ] 代码结构和组织
- [ ] 注释和文档
- [ ] 代码重复（DRY原则）

### 潜在问题
- [ ] 空指针/未定义值检查
- [ ] 错误处理
- [ ] 边界条件处理
- [ ] 资源泄漏（文件、连接等）
- [ ] 竞态条件

### 性能
- [ ] 算法复杂度
- [ ] 不必要的计算
- [ ] 数据库查询优化
- [ ] 内存使用
- [ ] 缓存策略

### 安全性
- [ ] 输入验证
- [ ] SQL注入风险
- [ ] XSS风险
- [ ] 敏感信息泄露
- [ ] 权限检查

### 最佳实践
- [ ] 设计模式使用
- [ ] 单一职责原则
- [ ] 依赖注入
- [ ] 测试覆盖
- [ ] 类型安全

## 输出格式

审查报告应包含：
1. **总体评价**：代码质量评分和总体印象
2. **优点**：代码做得好的地方
3. **问题列表**：发现的具体问题，包括：
   - 问题描述
   - 问题位置（文件名和行号）
   - 严重程度（高/中/低）
   - 修复建议
4. **改进建议**：具体的代码改进方案
5. **最佳实践建议**：相关的编码最佳实践

## 示例输出

```markdown
## 代码审查报告

### 总体评价
代码质量：良好（7/10）
- 代码结构清晰，逻辑合理
- 存在一些潜在的性能和安全问题需要关注

### 优点
- 函数命名清晰，易于理解
- 代码注释充分
- 错误处理完善

### 发现的问题

#### 高优先级
1. **潜在空指针异常** (line 45)
   - 问题：`user.name` 可能为 undefined
   - 建议：添加空值检查 `if (!user?.name) return;`

2. **性能问题** (line 78-82)
   - 问题：在循环中进行数据库查询
   - 建议：批量查询或使用 JOIN

#### 中优先级
3. **代码重复** (line 120-135, 150-165)
   - 问题：存在重复的验证逻辑
   - 建议：提取为公共函数

### 改进建议
1. 添加输入验证
2. 使用常量替代魔法数字
3. 考虑使用 TypeScript 严格模式
```

## 注意事项

- 审查时要客观、建设性
- 提供具体的、可操作的改进建议
- 区分严重程度，优先处理高优先级问题
- 考虑项目的上下文和约束条件
- 尊重代码作者的意图，提供改进而非批评

